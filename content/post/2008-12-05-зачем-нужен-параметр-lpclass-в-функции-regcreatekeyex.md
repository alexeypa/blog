---
author: admin
date: 2008-12-05 05:07:21+00:00
link: http://blog.not-a-kernel-guy.com/2008/12/04/377
slug: зачем-нужен-параметр-lpclass-в-функции-regcreatekeyex
title: Зачем нужен параметр lpClass в функции RegCreateKeyEx?
wordpress_id: 377
tags:
- Программирование
- Win32
---

Любой разработчик, кто хоть раз создавал ключ в реестре с помощью функции [RegCreateKeyEx](http://msdn.microsoft.com/en-us/library/ms724844(VS.85).aspx) задавался вопросом: «а зачем нужен параметр lpClass и что он означает?»

> _lpClass_ [in, optional]
> The user-defined class type of this key. This parameter may be ignored. This parameter can be NULL.

MSDN, в общем то, не даёт прямого ответа на этот вопрос. Самое забавное, что ответа на этот вопрос не знает никто, включая и текущего разработчика, ответственного за сопровождение реестра, и его предшественника. :-) Вернее не совсем так. Они, безусловно, знают какая функциональность стоит за этим параметром и как она реализована. Но они не имеют ни малейшего понятия, для чего эта возможность предназначалась изначально. Более того, известный своими экскурсами в историю [Raymond Chen](http://blogs.msdn.com/oldnewthing/) также не помнит, зачем это было нужно. Единственная ниточка - письмо другого разработчика, хоть немного проливающее свет, было безвозвратно утеряно. И, конечно же, люди это писавшие на пенсии давно. :-)

Так какая же функциональность скрывается за этим параметром сейчас? Этот параметр позволяет при создании ключа задать строку, которая будет храниться с этим ключом, пока тот не будет удалён. Эта строка может быть прочитана с помощью функции [RegQueryInfoKey](http://msdn.microsoft.com/en-us/library/ms724902(VS.85).aspx). Всё.

**Update**: напоминаю, что все бессмысленные комментарии режутся нещадно.
