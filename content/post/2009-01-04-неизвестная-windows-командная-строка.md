---
author: admin
comments: true
date: 2009-01-04 07:14:49+00:00
excerpt: None
link: http://blog.not-a-kernel-guy.com/2009/01/03/408
slug: неизвестная-windows-командная-строка
title: Неизвестная Windows - командная строка.
wordpress_id: 408
categories:
- itblogs
tags:
- Неизвестная Windows
---

Windows традиционно ругают за недоразвитую консоль. Ругают в первую очередь, конечно, за командный процессор (cmd.exe) - злую шутку случайной эволюции. Потом достаётся застрявшей в 1995 году консольной подсистеме в целом. Ну и на закуску остается отсутствие человеческой поддержки удаленного доступа к консоли (telnet/SSH). Короче ругают совершенно заслужено, но при этом, как мне кажется, делается подсознательный вывод, что консоль в Windows вообще ни для чего не годится. В результате упускается из виду, что в состав Windows входит множество утилит командной строки, которые могут быть весьма полезны. Дабы слегка исправить эту ситуацию, я собираюсь написать серию постов «Неизвестная Windows», посвященную консольным утилитам Windows.

Некоторое время назад, я попытался создать полную резервную копию своей машины. Первым делом выяснилось, что старый добрый NT Backup приказал долго жить и начиная с Vista в систему встроена другая утилита резервного копирования. Или этот был все тот же NT Backup в новом гриме? Так или иначе, дружественный UI предложил на выбор три опции: создать резервную копию на жестком диске, записать её на DVD или скопировать все на сетевую папку. Тут-то и ждали меня первые грабли. Мастер упорно отказывался использовать предложенную сетевую папку, не смотря на то, что он сам же успешно создавал на ней временные каталоги и файлы:



![](http://blog.not-a-kernel-guy.com/wp-content/uploads/2009/01/backup_wizard.png)

 

Поигравшись немного с Process Monitor, я решил, что дело должно быть в некое несовместимости Samba (сетевая папка была на внешнем диске под управлением Linux) и текущей версии Windows 7 и отложил проблему до лучших времен. Довольно скоро я наткнулся на письмо описывающее «мою» проблему. Как оказалось, существует довольно простой способ обойти эту сложность. Достаточно воспользоваться консольной утилитой wbadmin:



```no-highlight
c:\>wbadmin
wbadmin 1.0 - Backup command-line tool
(C) Copyright 2004 Microsoft Corp.

ERROR - Command incomplete. See the list below.
For Help for this command, type WBADMIN <command> /?.

---- Commands Supported ----

START BACKUP              -- Runs a one-time backup.
STOP JOB                  -- Stops the currently running backup or recovery
                              operation.
GET VERSIONS              -- List details of backups recoverable from a
                              specified location.
GET ITEMS                 -- Lists items contained in a backup.
GET STATUS                -- Reports the status of the currently running
                              operation.
```



Правильная команда:



```no-highlight
wbadmin start backup -backupTarget:\\server\share -allCritical -include:c:,d:
```



где:




  
  * -backupTarget задаёт имя папки, где будет создана резервная копия.


  
  * -allCritical копирует все системные диски.


  
  * -include указывает какие еще диски должны быть скопированы.


